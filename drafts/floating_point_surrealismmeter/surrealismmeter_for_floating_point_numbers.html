<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Surrealismmeter for floating point numbers</title>
    <meta name="keywords" content="programming,floating point,fixed point,error,learning">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
    <style>
body{
    margin: 0 0 0 0;
}

a{
    text-decoration: none;
}

h1 {
    padding-top: 32pt;
    font-size: 24pt;
    width: 600pt;
    text-align: left;
}

h2 {
    padding-top: 16pt;
    font-size: 20pt;
    width: 555pt;
    text-align: left;
}

p {
    font-size: 16pt;
    width: 505pt;
    text-align: left;
}

.comment {
    font-size: 12pt;
    text-align:center;
    font-family: sans-serif;
    padding-bottom: 24pt;
}

.formula {
    font-family: sans-serif;
    font-size: 15pt;
    font-style: italic;
    text-align: center;
    padding-top: 6pt;
    padding-bottom: 6pt;
}

.footer {
    margin-top: 64pt;
    padding-bottom: 32pt;
    font-family: sans-serif;
    font-size: 16pt;
    text-align: left;
}

table {
    font-family: sans-serif;
    font-size: 13pt;
    font-style: italic;
    width: 505pt;
    text-align: center;
}

td {
    vertical-align: text-top;
    padding-top: 6pt;
    padding-bottom: 6pt;
}

li {
    font-size: 16pt;
    width: 505pt;
    text-align: left;
    padding-bottom: 6pt;
}

form {
    margin: 0 0 0 0;
    padding-top: 12pt;
    padding-left: 12pt;
    padding-right: 12pt;
    padding-bottom: 12pt;
    font-size: 16pt;
    text-align: left;
    width: 505pt;
    background-color: #eeee99;
}

input[type="text"] {
    width: 32pt;
    height: 22pt;
    font-size: 16pt;
    text-align: center;
}

button {
    width: 32pt;
    height: 26pt;
    font-size: 16pt;
    text-align: center;
}

pre {
    margin: 0 0 0 0;
    padding-top: 12pt;
    padding-left: 12pt;
    padding-right: 12pt;
    padding-bottom: 12pt;
    font-size: 12pt;
    text-align: left;
    width: 505pt;
}
    </style>
    <script language="JavaScript">
const w = 640;
const h = 200;    
const cell_width = 64;    
const cell_height = 64;
const cell_y = 20;
    
// fixed point
fixed_cell_xs = [20, 20 + 90 + 43, 20 + 90*2 + 43, 20 + 90*3 + 43, 20 + 90*4 + 43*2, 20 + 90*5 + 43*2];
fixed_cell_colors = ["#dba0ac", "#cfa0db", "#cfa0db", "#cfa0db", "#cfa0db", "#cfa0db"];
fixed_cell_bits = [0, 0, 0, 1, 1, 0];

function init_fixed() {
    var fixed = document.getElementById("fixed");
    fixed_draw();
    
    fixed.addEventListener('click', function(e){
        var canvas_rect = fixed.getBoundingClientRect();
        var x = e.clientX - canvas_rect.left;
        var y = e.clientY - canvas_rect.top;
        for(var i = 0; i < fixed_cell_xs.length; ++i) {
            if (x > fixed_cell_xs[i] && x < fixed_cell_xs[i] + cell_width && y > cell_y && y < cell_y + cell_height)
                fixed_cell_bits[i] = 1 - fixed_cell_bits[i];
        }
        fixed_draw();
    }, false);
}

function fixed_draw() {
    var fixed = document.getElementById("fixed");
    var fixed_context = fixed.getContext("2d");

    // background
    fixed_context.fillStyle="#dbd5a0";
    fixed_context.fillRect(0, 0, w, h);
    
    // cells
    for(var i = 0; i < fixed_cell_xs.length; ++i) {
        fixed_context.fillStyle = fixed_cell_colors[i];
        fixed_context.fillRect(fixed_cell_xs[i], cell_y, cell_width, cell_height);
        
        fixed_context.textAlign = "center";
        fixed_context.textBaseline = "middle"; 
        fixed_context.font = "48px sans-serif";
        fixed_context.fillStyle = "#222222";        
        fixed_context.fillText(fixed_cell_bits[i], fixed_cell_xs[i] + cell_width / 2.0, cell_y + cell_height / 2.0 + 4);
    }
    
    // the number
    var sign = floating_cell_bits[0] ? -1.0 : 1.0;    
    var n = fixed_cell_bits[5] + 2*fixed_cell_bits[4] + 4*fixed_cell_bits[3] + 8*fixed_cell_bits[2] + 16*fixed_cell_bits[1];
    
    // explicit point
    fixed_context.fillStyle = "#597052";
    fixed_context.fillText(".", 430, cell_y + cell_height / 2.0 + 4);
    
    // comment
    fixed_context.fillStyle = "#914853"
    fixed_context.textAlign = "left";
    fixed_context.textBaseline = "alphabetic"; 
    fixed_context.font = "20px sans-serif";
    fixed_context.fillText(sign == -1.0 ? "Negative number" : "Positive number", 20, 120);

    fixed_context.fillStyle = "#673670"
    fixed_context.fillText("of " + n + " quarters,", 20, 145);
    fixed_context.fillText("which is " + sign * (n / 4.0).toFixed(2) + " in real numbers.", 20, 170);
}

// floating point
floating_cell_xs = [20, 20 + 90 + 43 - 32, 20 + 90*2 + 43 - 32, 20 + 90*3 + 43 - 32, 20 + 90*4 + 43*2, 20 + 90*5 + 43*2];
floating_cell_colors = ["#dba0ac", "#acdba0", "#acdba0", "#acdba0", "#cfa0db", "#cfa0db"];
floating_cell_bits = [0, 0, 0, 1, 1, 0];

function init_floating() {
    var floating = document.getElementById("floating");
    floating_draw();
    
    floating.addEventListener('click', function(e){
        var canvas_rect = floating.getBoundingClientRect();
        var x = e.clientX - canvas_rect.left;
        var y = e.clientY - canvas_rect.top;
        for(var i = 0; i < floating_cell_xs.length; ++i) {
            if (x > floating_cell_xs[i] && x < floating_cell_xs[i] + cell_width && y > cell_y && y < cell_y + cell_height)
                floating_cell_bits[i] = 1 - floating_cell_bits[i];
        }
        floating_draw();
    }, false);
}

function floating_draw() {
    var floating = document.getElementById("floating");
    var floating_context = floating.getContext("2d");

    // background
    floating_context.fillStyle="#dbd5a0";
    floating_context.fillRect(0, 0, w, h);
    
    // cells
    for(var i = 0; i < floating_cell_xs.length; ++i) {
        floating_context.fillStyle = floating_cell_colors[i];
        floating_context.fillRect(floating_cell_xs[i], cell_y, cell_width, cell_height);
        
        floating_context.textAlign = "center";
        floating_context.textBaseline = "middle"; 
        floating_context.font = "48px sans-serif";
        floating_context.fillStyle = "#222222";        
        floating_context.fillText(floating_cell_bits[i], floating_cell_xs[i] + cell_width / 2.0, cell_y + cell_height / 2.0 + 4);
    }
    
    // the number
    var sign = floating_cell_bits[0] ? -1.0 : 1.0;
    var e = floating_cell_bits[3] + floating_cell_bits[2] * 2 + floating_cell_bits[1] * 4;
    var n = floating_cell_bits[5] + floating_cell_bits[4] * 2 + ((e != 0 && e != 7) ? 4 : 0);
    
    // explicit point
    if (e != 0 && e != 7) {
        floating_context.fillStyle = "#673670";
        floating_context.fillText("1", 420, cell_y + cell_height / 2.0 + 4);    
    }
    
    // comment
    floating_context.textAlign = "left";
    floating_context.textBaseline = "alphabetic"; 
    floating_context.font = "20px sans-serif";
            
    if( e == 7 ) {
        if ( n == 0 ) {
            floating_context.fillStyle = "#914853";
            floating_context.fillText(sign == -1.0 ? "Negative" : "Positive", 20, 120);
            floating_context.fillStyle = "#673670";
            floating_context.fillText("infinite number.", 20, 145);
        } else {
            floating_context.fillStyle = "#673670";
            floating_context.fillText("Not a number.", 20, 120);
        }
    } else {
        floating_context.fillStyle = "#914853";
        floating_context.fillText(sign == -1.0 ? "Negative number" : "Positive number", 20, 120);
        
        floating_context.fillStyle = "#673670"
        floating_context.fillText("of " + n, 20, 145);
        floating_context.fillStyle = "#597052";
        var measures = "quarters,";
        if(e == 2)
            measures = "halves,";
        if(e == 3)
            measures = "wholes,";
        if(e == 4)
            measures = "pairs,";
        if(e == 5)
            measures = "four-packs,";
        if(e == 6)
            measures = "eight-packs,";
        floating_context.fillText(measures, 64, 145);
        
        floating_context.fillStyle = "#673670"
        floating_context.fillText("which is " + sign * (n * Math.pow(2, e - 2 - (e > 0 ? 1 : 0))).toFixed(2) + " in real numbers", 20, 170);
    }
}


// tri-float to RGB
function as_XX(x) {
    return ((x < 16) ? "0" : "") +x.toString(16);
}

function as_RRGGBB(r_01, g_01, b_01) {
    var rgb = [r_01, g_01, b_01];
    var RRGGBB = "#";
    for(var i = 0; i < 3; ++i) {
        if (rgb[i] < 0.0)
            rgb[i] = 0.0;
        if (rgb[i] > 255.0/256.0)
            rgb[i] = 255.0/256;
        RRGGBB += as_XX(Math.trunc(rgb[i] * 256.0));
    }
    return RRGGBB;
}

    </script>
  </head>
  <body>
    <center>
    <h1>
Surrealismmeter for floating point numbers
    </h1>
    <p>
I hope we can all agree: floating point numbers are not real. They are just fancy integers that can't make up their mind.
    </p>
    <p>
Let me elaborate on that. For a contrast, here is a 6-bit <b>fixed point</b> number. It's basically an integer number of quarters.
    </p>
    <canvas id="fixed" width=640 height=200></canvas>
    <p class="comment">
Bit cells are, of course, clickable.
    </p>
    <p>
It is simple, and it has simple limitations. You can't have numbers less than 0.25, and you can't have numbers greater than 7.75.
    </p>
    <p>
And here is a 6-bit <b>floating point</b> number:
    </p>
    <canvas id="floating" width=640 height=200></canvas>
    <script language="JavaScript">
        init_fixed();
        init_floating();
    </script>
    
    <h2>
P. S.
    </h2>
    <p>
All the <a href="https://github.com/akalenuk/wordsandbuttons">source code</a> for this site is available on GitHub. This particular page is: <a href="https://github.com/akalenuk/wordsandbuttons/blob/master/pages/nurbs_is_just_an_acronym.html">https://github.com/.../pages/nurbs_is_just_an_acronym.html</a>. If you want to play with NURBS more extensively than this page allows you, please do.
    </p>

    <p class="footer">
    <a class="twitter-share-button"
  href="https://twitter.com/intent/tweet?text=Gentle+explanation+of+NURBS.+No+code+or+formulas%2C+just+plots%2C+sliders%2C+and+buttons&url=http://wordsandbuttons.online/nurbs_is_just_an_acronym.html&hashtags=nurbs,splines,curves&via=wordsandbuttons"
  data-size="large">
Tweet</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <br>     
There are more words and buttons on <a href="index.html">wordsandbuttons.online</a>.
    </p>
    </center>
  </body>
</html>
