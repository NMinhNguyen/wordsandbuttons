<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Programmer's introduction to linear systems</title>
    <meta name="keywords" content="programming,linear equations,linear systems,tutorial,guide,learning">
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
    <style>
body{
    margin: 0 0 0 0;
}

a{
    text-decoration: none;
}

h1 {
    padding-top: 32pt;
    font-size: 24pt;
    width: 600pt;
    text-align: left;
}

h2 {
    padding-top: 16pt;
    font-size: 20pt;
    width: 555pt;
    text-align: left;
}

p {
    font-size: 16pt;
    width: 505pt;
    text-align: left;
}

.results {
    font-family: sans-serif;
    font-size: 14pt;
    width: 505pt;
    text-align: left;
}

.comment {
    font-size: 12pt;
    text-align:center;
    font-family: sans-serif;
    padding-bottom: 24pt;
}

.formula {
    font-family: monospace;
    font-size: 16pt;
    font-style: italic;
    text-align: center;
    padding-top: 6pt;
    padding-bottom: 6pt;
}

.footer {
    margin-top: 64pt;
    padding-bottom: 32pt;
    font-family: sans-serif;
    font-size: 16pt;
    text-align: left;
}

li {
    font-size: 16pt;
    width: 505pt;
    text-align: left;
    padding-bottom: 6pt;
}

form {
    margin: 0 0 0 0;
    padding-top: 12pt;
    padding-left: 12pt;
    padding-right: 12pt;
    padding-bottom: 12pt;
    font-size: 16pt;
    text-align: left;
    width: 505pt;
    background-color: #eeee99;
}

table {
    border-width: 0pt;
    padding-top: 12pt;
    padding-left: 12pt;
    padding-right: 12pt;
    padding-bottom: 12pt;
    font-size: 16pt;
    font-family: monospace;
    text-align: center;
}

table td {
    padding: 0pt 3pt 0pt 3pt;
    margin: 0 0 0 0;
    border-width: 0pt;
}

.brackets {
    font-size:32pt;
    padding-bottom:2pt;
    font-family: sans-serif;
    font-weight: 100;
    font-style: normal;
}

input[type="text"] {
    width: 20pt;
    height: 22pt;
    margin: 0;
    padding-left: 1pt;
    font-size: 14pt;
}

button {
    width: 108pt;
    height: 28pt;
    margin-left:4pt;
    margin-right:4pt;
    font-size: 16pt;
}

.incdec {
    width: 22pt;
    height: 22pt;
    margin-left: 1pt;
    margin-right: 1pt;
    font-size: 14pt;
}
    </style>
    <script language="JavaScript">

// client
var w = 640.0;
var h = 512.0;

// visible region
var x_min = -1.0;
var y_min = -1.0;
var x_max = 5.0;
var y_max = 4.0;

// colors
var line_colors = ["#d64562", "#457fd6", "#62d645", "#d98146"];

var client_x_center = w*(0-x_min)/(x_max-x_min);
var client_x_step = (w/(x_max-x_min));

var client_y_center = h - h*(0-y_min)/(y_max-y_min);
var client_y_step = (h/(y_max-y_min));

function client_to_x(client_x){
    return (client_x - client_x_center) / client_x_step;
}

function client_to_y(client_y){
    return (client_y_center - client_y) / client_y_step;
}

function x_to_client(x){
    return x * client_x_step + client_x_center;
}

function y_to_client(y){
    return client_y_center - y * client_y_step;
}

function draw_grid_on(context){
    context.font = "16px sans-serif";
    // axes
    context.beginPath();
    context.moveTo(0, client_y_center);
    context.lineTo(w, client_y_center);
    context.lineTo(w - 12, client_y_center - 5);
    context.moveTo(w, client_y_center);
    context.lineTo(w - 12, client_y_center + 5);
    context.moveTo(client_x_center, h);
    context.lineTo(client_x_center, 0);
    context.lineTo(client_x_center - 5, 12);
    context.moveTo(client_x_center, 0);
    context.lineTo(client_x_center + 5, 12);
    context.fillStyle="#000000";
    // numbers
    for(var i = x_min + 1; i <= x_max - 1; i++){
        context.moveTo(client_x_center + i*client_x_step, client_y_center);
        context.lineTo(client_x_center + i*client_x_step, client_y_center - 5);
        context.fillText(i, client_x_center + i*client_x_step + 4, client_y_center + 16);
    }
    for(var i = y_min + 1; i <= y_max - 1; i++){
        context.moveTo(client_x_center, client_y_center - i*client_y_step);
        context.lineTo(client_x_center + 5, client_y_center - i*client_y_step);
        context.fillText(i, client_x_center + 5, client_y_center - i*client_y_step + 16);
    }
    // letters
    context.fillText("X1", client_x_center + x_max*client_x_step - 24, client_y_center - 16);
    context.fillText("X2", client_x_center - 30, client_y_center - y_max*client_y_step + 16);
    
    context.strokeStyle="#000000";
    context.stroke();
    context.closePath();
}

function dot_of(a11, a12, a21, a22){
    return a11*a21 + a12*a22;
}

function length_of(a1, a2){
    return Math.sqrt(dot_of(a1, a2, a1, a2));
}

function projected_x(x, y, a1, a2, b){
    return x + a1 * (b - dot_of(x, y, a1, a2)) / dot_of(a1, a2, a1, a2);
}

function projected_y(x, y, a1, a2, b){
    return y + a2 * (b - dot_of(x, y, a1, a2)) / dot_of(a1, a2, a1, a2);
}

function get_points_on_the_ends(a1, a2, b) {
    var xys = []
    
    var x_in_y_min = (b - a2 * y_min)/ a1;
    if(x_in_y_min >= x_min && x_in_y_min < x_max)
        xys.push([x_in_y_min, y_min]);
      
    var x_in_y_max = (b - a2 * y_max)/ a1;
    if(x_in_y_max >= x_min && x_in_y_max < x_max)
        xys.push([x_in_y_max, y_max]);
      
    var y_in_x_min = (b - a1 * x_min) / a2;
    if(y_in_x_min >= y_min && y_in_x_min < y_max)
        xys.push([x_min, y_in_x_min]);

    var y_in_x_max = (b - a1 * x_max) / a2;
    if(y_in_x_max >= y_min && y_in_x_max < y_max)
        xys.push([x_max, y_in_x_max]);
    
    if(xys.length < 2)
        return get_points_on_the_ends(a1, a2, b + 0.01);
    return xys;
}

function equation_for_two_points(x1, y1, x2, y2) {
    return [1.0, (-x1 + x2)/(y1 - y2), (-x1*y2 + x2*y1)/(y1 - y2)];
}

function new_equation_for_one_point(a1, a2, b, x, y) {
    var xys = get_points_on_the_ends(a1, a2, b);
    if(length_of(x - xys[0][0], y - xys[0][1]) > length_of(x - xys[1][0], y - xys[1][1])) {
        return equation_for_two_points(x, y, xys[0][0], xys[0][1]);
    } else {
        return equation_for_two_points(x, y, xys[1][0], xys[1][1]);
    }
}

function solve_2(a11, a12, b1, a21, a22, b2) {
    sx = (-a12*b2 + a22*b1)/(a11*a22 - a12*a21);
    sy = (a11*b2 - a21*b1)/(a11*a22 - a12*a21);
    return [sx, sy];
}

//////
/// simple plots
function invalidate_plot_named(name) {
    var temp_id = eval(name + "_eq_temp_id");
    eval(name + "_eq_" + temp_id + " = Array.from(" + name + "_eq_" + temp_id + "_temp);");
    draw_plot_named(name, 0, 0, false);
    update_system(name);
    update_matrix(name);
}

function init_plot_named(name) {
    plot = document.getElementById(name);
    var canvas_rect = plot.getBoundingClientRect();
    invalidate_plot_named(name);

    plot.addEventListener('mousemove', function(e){
       var canvas_rect = plot.getBoundingClientRect();
       draw_plot_named(name, e.clientX - canvas_rect.left, e.clientY - canvas_rect.top, true);
       if(e.buttons == 1){
           invalidate_plot_named(name);
       }
    }, false);

    plot.addEventListener('mousedown', function(e){
        invalidate_plot_named(name);
    }, false);
    
    plot.addEventListener('mouseup', function(e){
        invalidate_plot_named(name);
    }, false);

    plot.addEventListener('mouseleave', function(e){
       draw_plot_named(name, 0, 0, false);
    }, false);
}

function draw_plot_named(name, client_x, client_y, do_guides) {
    plot = document.getElementById(name);
    var context = plot.getContext("2d");

    // background
    context.fillStyle="#eeeeee";
    context.fillRect(0, 0, w, h);
    
    // equations
    for(var i = 0; i < eval(name + "_eqs"); ++i) {
        context.beginPath();
        var eq = eval(name + "_eq_" + (i+1));
        var xys = get_points_on_the_ends(eq[0], eq[1], eq[2]);
        context.moveTo(x_to_client(xys[0][0]), y_to_client(xys[0][1]));
        context.lineTo(x_to_client(xys[1][0]), y_to_client(xys[1][1]));
        context.strokeStyle = line_colors[i];
        context.lineWidth = 2;
        context.stroke();
        context.closePath();
        context.lineWidth = 1;
    }
    
    // grid
    draw_grid_on(context);
    
    if(do_guides){
        var x = client_to_x(client_x);
        var y = client_to_y(client_y);
              
        // find the nearest equation
        var closest_eq_i = 0;
        var eq0 = eval(name + "_eq_1");
        var x0 = projected_x(x, y, eq0[0], eq0[1], eq0[2]);
        var y0 = projected_y(x, y, eq0[0], eq0[1], eq0[2]);
        var closest_distance = length_of(x - x0, y - y0);
        for(var i = 1; i < eval(name + "_eqs"); ++i) {
            var eq = eval(name + "_eq_" + (i+1));
            var xi = projected_x(x, y, eq[0], eq[1], eq[2]);
            var yi = projected_y(x, y, eq[0], eq[1], eq[2]);
            var distancei = length_of(x - xi, y - yi);
            if (distancei < closest_distance) {
                closest_distance = distancei;
                closest_eq_i = i;
            }
        }        
        eval(name + "_eq_temp_id = closest_eq_i + 1;");
        
        // draw the quide
        var closest_eq = eval(name + "_eq_" + (closest_eq_i + 1));
        var temp_eq = new_equation_for_one_point(closest_eq[0], closest_eq[1], closest_eq[2], x, y);
        eval(name + "_eq_" + (closest_eq_i + 1) + "_temp = Array.from(temp_eq);");
        context.beginPath();
        var xys = get_points_on_the_ends(temp_eq[0], temp_eq[1], temp_eq[2]);
        context.moveTo(x_to_client(xys[0][0]), y_to_client(xys[0][1]));
        context.lineTo(x_to_client(xys[1][0]), y_to_client(xys[1][1]));
        context.strokeStyle = line_colors[closest_eq_i];
        context.setLineDash([4, 4]);
        context.stroke();
        context.setLineDash([]);
        context.closePath();
    }
}




//////
/// equations and matrix
function printable(a) {
    a_trimmed = Number(a.toFixed(2));
    if (Number.isInteger(a_trimmed))
        return a_trimmed;
    return a.toFixed(2);
}

function coefficient(a, x) {
    a_trimmed = Number(a.toFixed(2));
    if (a_trimmed == 1)
        return x;
    if (a_trimmed == -1)
        return "-" + x;
    if (a_trimmed == 0)
        return "";
    return printable(a) + x;
}

function update_matrix(name) {
    if(document.getElementById(name + "_matrix_col1") == null)
        return;
        
    document.getElementById(name + "_matrix_col1").innerHTML = 
        printable(system_1_eq_1[0]) + "<br>" + printable(system_1_eq_2[0]);
    document.getElementById(name + "_matrix_col2").innerHTML = 
        printable(system_1_eq_1[1]) + "<br>" + printable(system_1_eq_2[1]);
    document.getElementById(name + "_matrix_col3").innerHTML = 
        printable(system_1_eq_1[2]) + "<br>" + printable(system_1_eq_2[2]);
}

function update_system(name) {
    if(document.getElementById(name + "_system_row1") == null)
        return;
        
    document.getElementById(name + "_system_row1").innerHTML = 
        coefficient(system_1_eq_1[0], "x<sub>1</sub>") + " + " +
        coefficient(system_1_eq_1[1], "x<sub>2</sub>") + " = " +
        printable(system_1_eq_1[2]);
    document.getElementById(name + "_system_row2").innerHTML = 
        coefficient(system_1_eq_2[0], "x<sub>1</sub>") + " + " +
        coefficient(system_1_eq_2[1], "x<sub>2</sub>") + " = " +
        printable(system_1_eq_2[2]);
}



//////
/// systems
const system_1_eqs = 2;
var system_1_eq_1;
var system_1_eq_2;

var system_1_eq_temp_id = 1;
var system_1_eq_1_temp = system_1_eq_1;
var system_1_eq_2_temp = system_1_eq_2;

function set_system_1() {
    system_1_eq_1 = [1.0, -1.35, 0.4];
    system_1_eq_2 = [1.0, 2.0, 7.0];

    system_1_eq_temp_id = 1;
    system_1_eq_1_temp = system_1_eq_1;
    system_1_eq_2_temp = system_1_eq_2;
}
set_system_1();

function reset_system_1() {
    set_system_1();
    draw_plot_named('system_1', 0, 0, false);
    update_matrix('system_1');
    update_system('system_1');
}

function done_system_1_quest_1() {
    var xy = solve_2(system_1_eq_1[0], system_1_eq_1[1], system_1_eq_1[2], system_1_eq_2[0], system_1_eq_2[1], system_1_eq_2[2]);
    if(Math.abs(xy[0]) > 0.25 || Math.abs(xy[1]) > 0.25) {
        document.getElementById("reply_quest_1").innerHTML = "Sorry, please try again.";
    } else if(Math.abs(xy[0]) >= 0.01 || Math.abs(xy[1]) >= 0.01) {
        document.getElementById("reply_quest_1").innerHTML = "Close enough! Yes!";
        document.getElementById("buttons_quest_1").style.display = 'none';        
    } else {
        document.getElementById("reply_quest_1").innerHTML = "Excellent!";
        document.getElementById("buttons_quest_1").style.display = 'none';
    }
    draw_plot_named('system_1', 0, 0, false);
}

function done_system_1_quest_2() {
    var xy = solve_2(system_1_eq_1[0], system_1_eq_1[1], system_1_eq_1[2], system_1_eq_2[0], system_1_eq_2[1], system_1_eq_2[2]);
    if(Math.abs(xy[0]) < 50 && Math.abs(xy[1]) < 50) {
        document.getElementById("reply_quest_2").innerHTML = "Sorry, it still has a solution in <i>x<sub>1</sub> =" + printable(xy[0]) + ", x<sub>2</sub> = " + printable(xy[1]) + "</i>. Please try again.";
    } else {
        document.getElementById("reply_quest_2").innerHTML = "Yes! When the lines are parallel, there is no solution";
        document.getElementById("buttons_quest_2").style.display = 'none';
    }
    draw_plot_named('system_1', 0, 0, false);
}

function done_system_1_quest_3() {
    xyxy1 = get_points_on_the_ends(system_1_eq_1[0], system_1_eq_1[1], system_1_eq_1[2]);
    xyxy2 = get_points_on_the_ends(system_1_eq_2[0], system_1_eq_2[1], system_1_eq_2[2]);
    if(Math.abs(xyxy1[0][0] - xyxy2[0][0]) > 0.1 || 
       Math.abs(xyxy1[0][1] - xyxy2[0][1]) > 0.1 || 
       Math.abs(xyxy1[1][0] - xyxy2[1][0]) > 0.1 ||
       Math.abs(xyxy1[1][1] - xyxy2[1][1]) > 0.1) {
        var xy = solve_2(system_1_eq_1[0], system_1_eq_1[1], system_1_eq_1[2], system_1_eq_2[0], system_1_eq_2[1], system_1_eq_2[2]);
        document.getElementById("reply_quest_3").innerHTML = "Sorry, it still has a single solution in <i>x<sub>1</sub> =" + printable(xy[0]) + ", x<sub>2</sub> = " + printable(xy[1]) + "</i>. Please try again.";
    } else {
        document.getElementById("reply_quest_3").innerHTML = "Yes! When the lines coincide, the solutions are infinite.";
        document.getElementById("buttons_quest_3").style.display = 'none';
    }
    draw_plot_named('system_1', 0, 0, false);
}


const system_2_eqs = 3;
var system_2_eq_1;
var system_2_eq_2;
var system_2_eq_3;

var system_2_eq_temp_id = 1;
var system_2_eq_1_temp = system_2_eq_1;
var system_2_eq_2_temp = system_2_eq_2;
var system_2_eq_3_temp = system_2_eq_3;

function set_system_2() {
    system_2_eq_1 = [1.0, -1.35, 0.4];
    system_2_eq_2 = [1.0, 2.0, 7.0];
    system_2_eq_3 = [1.0, 0.3, 1.6];

    system_2_eq_temp_id = 1;
    system_2_eq_1_temp = system_2_eq_1;
    system_2_eq_2_temp = system_2_eq_2;
    system_2_eq_3_temp = system_2_eq_3;
}
set_system_2();

function reset_system_2() {
    set_system_2();
    draw_plot_named('system_2', 0, 0, false);
}

function done_system_2_quest_4() {
    var xy1 = solve_2(system_2_eq_1[0], system_2_eq_1[1], system_2_eq_1[2], system_2_eq_2[0], system_2_eq_2[1], system_2_eq_2[2]);
    var xy2 = solve_2(system_2_eq_2[0], system_2_eq_2[1], system_2_eq_2[2], system_2_eq_3[0], system_2_eq_3[1], system_2_eq_3[2]);
    var xy3 = solve_2(system_2_eq_3[0], system_2_eq_3[1], system_2_eq_3[2], system_2_eq_1[0], system_2_eq_1[1], system_2_eq_1[2]);    
    if(Math.abs(xy1[0] - xy2[0]) > 0.1 || 
       Math.abs(xy1[1] - xy2[1]) > 0.1){
        document.getElementById("reply_quest_4").innerHTML = "It has intersections, but not a solution. Please try again.";
    } else {
        document.getElementById("reply_quest_4").innerHTML = "Yes! The solution is when all the three lines intersect in the same point.";
        document.getElementById("buttons_quest_4").style.display = 'none';
    }
    draw_plot_named('system_2', 0, 0, false);
}

function almost(a, b) {
    return Math.abs(a-b) < 1.e-5;
}


function done_system_3_quest_5() {
    var a11 =  Number(document.getElementById("s3_1_1").value);
    var a12 =  Number(document.getElementById("s3_1_2").value);
    var a13 =  Number(document.getElementById("s3_1_3").value);
    var b1 =  Number(document.getElementById("s3_1_4").value);
    var a21 =  Number(document.getElementById("s3_2_1").value);
    var a22 =  Number(document.getElementById("s3_2_2").value);
    var a23 =  Number(document.getElementById("s3_2_3").value);
    var b2 =  Number(document.getElementById("s3_2_4").value);

    if(almost(a11 / a21, a12 / a22) && almost(a11 / a21, a13 / a23))
    {
        if(almost(a11 / a21, b1 / b2))
        {
            document.getElementById("reply_quest_5").innerHTML = "Well, they are linerly dependant, this means they are the same plane. Still, any point on this plane is a solution.";
        } else {
            document.getElementById("reply_quest_5").innerHTML = "Exactly! Parallel planes in a system have their matrix part linear dependent and the vector part — not.";
            document.getElementById("buttons_quest_5").style.display = 'none';
        }
    } else {
        document.getElementById("reply_quest_5").innerHTML = "It has an infinite number of solutions. Planes instersection is a line. Every point in this line is a valid solution.";
    }
}

//////
/// solver

// lines
var a11 = -0.9;
var a12 = 1.0;
var b1 = -1.0;
var a21 = -0.15;
var a22 = 1.0;
var b2 = 2.5;

// start
var start_x = 1.0;
var start_y = 1.0;

// margin
var end_step_length = 0.3;

// temps
var temp_a11 = 0.0;
var temp_a12 = 0.0;
var temp_b1 = 0.0;
var temp_a21 = 0.0;
var temp_a22 = 0.0;
var temp_b2 = 0.0;

var temp_end_step_length = 0.5;

function invalidate_solver(client_x, client_y){
    var canvas_rect = solver.getBoundingClientRect();
    if(document.getElementById("button_1").disabled){
           a11 = temp_a11;
           a12 = temp_a12;
           b1 = temp_b1;
       }else if(document.getElementById("button_2").disabled){
           a21 = temp_a21;
           a22 = temp_a22;
           b2 = temp_b2;
       }else if(document.getElementById("button_3").disabled){
           start_x = client_to_x(client_x - canvas_rect.left);
           start_y = client_to_y(client_y - canvas_rect.top);
       }else if(document.getElementById("button_4").disabled){
           end_step_length = temp_end_step_length;
       }
    solver_draw(0, 0, false);
    check_ex();
}

function init_solver(){
    solver = document.getElementById("solver");
    var canvas_rect = solver.getBoundingClientRect();
    solver_draw(0, 0, false);

    solver.addEventListener('mousemove', function(e){
        var canvas_rect = solver.getBoundingClientRect();
        solver_draw(e.clientX - canvas_rect.left, e.clientY - canvas_rect.top, true);
        if(e.buttons == 1){
            invalidate_solver(e.clientX, e.clientY);
        }
    }, false);

    solver.addEventListener('mouseup', function(e){
        invalidate_solver(e.clientX, e.clientY);
    }, false);

    solver.addEventListener('mouseleave', function(e){
        solver_draw(0, 0, false);
    }, false);
}

var last_iterations = 100;
var last_error = 100.;
function solver_draw(client_x, client_y, do_guides){
    solver = document.getElementById("solver");
    var solver_context = solver.getContext("2d");
    solver_context.font = "16px sans-serif";
    // background
    solver_context.fillStyle="#eeeeee";
    solver_context.fillRect(0, 0, w, h);

    // red margin
    solver_context.beginPath();
    var db1 = end_step_length * length_of(a11, a12);
    solver_context.moveTo(x_to_client(x_min), y_to_client((b1 - db1 - a11*(x_min))/a12));
    solver_context.lineTo(x_to_client(x_max), y_to_client((b1 - db1 - a11*(x_max))/a12));
    solver_context.lineTo(x_to_client(x_max), y_to_client((b1 + db1 - a11*(x_max))/a12));
    solver_context.lineTo(x_to_client(x_min), y_to_client((b1 + db1 - a11*(x_min))/a12));
    solver_context.lineTo(x_to_client(x_min), y_to_client((b1 - db1 - a11*(x_min))/a12));
    solver_context.strokeStyle="#ff8866";
    solver_context.stroke();
    solver_context.closePath();
    solver_context.fillStyle="#ffddbb";
    solver_context.fill();

    // blue margin
    solver_context.beginPath();
    var db2 = end_step_length * length_of(a21, a22);
    solver_context.moveTo(x_to_client(x_min), y_to_client((b2 - db2 - a21*(x_min))/a22));
    solver_context.lineTo(x_to_client(x_max), y_to_client((b2 - db2 - a21*(x_max))/a22));
    solver_context.lineTo(x_to_client(x_max), y_to_client((b2 + db2 - a21*(x_max))/a22));
    solver_context.lineTo(x_to_client(x_min), y_to_client((b2 + db2 - a21*(x_min))/a22));
    solver_context.lineTo(x_to_client(x_min), y_to_client((b2 - db2 - a21*(x_min))/a22));
    solver_context.strokeStyle="#6699ff";
    solver_context.stroke();
    solver_context.closePath();
    solver_context.fillStyle="#bbddff";
    solver_context.fill();

    // red line
    solver_context.beginPath();
    var xys = get_points_on_the_ends(a11, a12, b1);
    solver_context.moveTo(x_to_client(xys[0][0]), y_to_client(xys[0][1]));
    solver_context.lineTo(x_to_client(xys[1][0]), y_to_client(xys[1][1]));
    solver_context.strokeStyle="#dd6644";
    solver_context.stroke();
    solver_context.closePath();

    // blue line
    solver_context.beginPath();
    var xys = get_points_on_the_ends(a21, a22, b2);
    solver_context.moveTo(x_to_client(xys[0][0]), y_to_client(xys[0][1]));
    solver_context.lineTo(x_to_client(xys[1][0]), y_to_client(xys[1][1]));
    solver_context.strokeStyle="#3366dd";
    solver_context.stroke();
    solver_context.closePath();

    // solver
    solver_context.beginPath();
    solver_context.moveTo(x_to_client(start_x), y_to_client(start_y));
    var prev_x = start_x + end_step_length + 1.;    // not to fall as done
    var prev_y = start_y;
    var cur_x = start_x;
    var cur_y = start_y;
    var i;
    for(i = 0; i <= 100; i++) // max iterations = 100
    {
        if(length_of(prev_x - cur_x, prev_y - cur_y) < end_step_length)
            break;  // done
        prev_x = cur_x;
        prev_y = cur_y;
        if(i % 2 == 0){
            cur_x = projected_x(prev_x, prev_y, a11, a12, b1);
            cur_y = projected_y(prev_x, prev_y, a11, a12, b1);
        }else{
            cur_x = projected_x(prev_x, prev_y, a21, a22, b2);
            cur_y = projected_y(prev_x, prev_y, a21, a22, b2);
        }
        solver_context.lineTo(x_to_client(cur_x), y_to_client(cur_y));
    }
    solver_context.strokeStyle="#446644";
    solver_context.stroke();
    solver_context.closePath();

    // grid
    draw_grid_on(solver_context);


    // mouse move
    if(do_guides){
        if(document.getElementById("button_1").disabled){
            var x = client_to_x(client_x);
            var y = client_to_y(client_y);
            var temp_eq = new_equation_for_one_point(a11, a12, b1, x, y);
            temp_a11 = temp_eq[0];
            temp_a12 = temp_eq[1];
            temp_b1 = temp_eq[2];
            solver_context.beginPath();
            solver_context.setLineDash([4, 4]);
            solver_context.moveTo(x_to_client(x_min), y_to_client((temp_b1 - temp_a11*(x_min))/temp_a12));
            solver_context.lineTo(x_to_client(x_max), y_to_client((temp_b1 - temp_a11*(x_max))/temp_a12));
            solver_context.strokeStyle="#dd6644";
            solver_context.stroke();
            solver_context.setLineDash([]);
            solver_context.closePath();
        }else if(document.getElementById("button_2").disabled){
            var x = client_to_x(client_x);
            var y = client_to_y(client_y);
            var temp_eq = new_equation_for_one_point(a21, a22, b2, x, y);
            temp_a21 = temp_eq[0];
            temp_a22 = temp_eq[1];
            temp_b2 = temp_eq[2];
            solver_context.beginPath();
            solver_context.setLineDash([4, 4]);
            solver_context.moveTo(x_to_client(x_min), y_to_client((temp_b2 - temp_a21*(x_min))/temp_a22));
            solver_context.lineTo(x_to_client(x_max), y_to_client((temp_b2 - temp_a21*(x_max))/temp_a22));
            solver_context.strokeStyle="#3366dd";
            solver_context.stroke();
            solver_context.setLineDash([]);
            solver_context.closePath();
        }else if(document.getElementById("button_3").disabled){
            solver_context.beginPath();
            solver_context.setLineDash([4, 4]);
            solver_context.moveTo(x_to_client(start_x), y_to_client(start_y));
            solver_context.lineTo(client_x, client_y);
            solver_context.strokeStyle="#557755";
            solver_context.stroke();
            solver_context.setLineDash([]);
            solver_context.closePath();
           }else if(document.getElementById("button_4").disabled){
            var x = client_to_x(client_x);
            var y = client_to_y(client_y);
            var x1 = projected_x(x, y, a11, a12, b1);
            var y1 = projected_y(x, y, a11, a12, b1);
            var x2 = projected_x(x, y, a21, a22, b2);
            var y2 = projected_y(x, y, a21, a22, b2);
            var d1 = length_of(x-x1, y-y1);
            var d2 = length_of(x-x2, y-y2);
            if(d1<d2){
                temp_end_step_length = d1;
            }else{
                temp_end_step_length = d2;
            }
               // red
               solver_context.beginPath();
            solver_context.setLineDash([4, 4]);
            var db1 = temp_end_step_length * length_of(a11, a12);
            solver_context.moveTo(x_to_client(x_min), y_to_client((b1 - db1 - a11*(x_min))/a12));
            solver_context.lineTo(x_to_client(x_max), y_to_client((b1 - db1 - a11*(x_max))/a12));
            solver_context.moveTo(x_to_client(x_min), y_to_client((b1 + db1 - a11*(x_min))/a12));
            solver_context.lineTo(x_to_client(x_max), y_to_client((b1 + db1 - a11*(x_max))/a12));
            solver_context.strokeStyle="#ff8866";
            solver_context.stroke();
            solver_context.setLineDash([]);
            solver_context.closePath();
            // blue
            solver_context.beginPath();
            solver_context.setLineDash([4, 4]);
            var db2 = temp_end_step_length * length_of(a21, a22);
            solver_context.moveTo(x_to_client(x_min), y_to_client((b2 - db2 - a21*(x_min))/a22));
            solver_context.lineTo(x_to_client(x_max), y_to_client((b2 - db2 - a21*(x_max))/a22));
            solver_context.moveTo(x_to_client(x_min), y_to_client((b2 + db2 - a21*(x_min))/a22));
            solver_context.lineTo(x_to_client(x_max), y_to_client((b2 + db2 - a21*(x_max))/a22));
            solver_context.strokeStyle="#6699ff";
            solver_context.stroke();
            solver_context.setLineDash([]);
            solver_context.closePath();
        }
    }

    // iteration count
    results = document.getElementById("results");
    if(i > 100){
        results.innerHTML = "Iterations > 100";
    }else{
        results.innerHTML = "Iterations = " + i;
    }
    last_iterations = i;
    // solution
    sxy = solve_2(a11, a12, b1, a21, a22, b2);
    results.innerHTML += "<br>";
    results.innerHTML += "Solution found: (" + cur_x.toFixed(3) + "; " + cur_y.toFixed(3) + "), ";
    results.innerHTML += "<i>actual solution: (" + sxy[0].toFixed(3) + "; " + sxy[1].toFixed(3) + ")</i>";
    error = length_of(sxy[0] - cur_x, sxy[1] - cur_y);
    results.innerHTML += "<br>";
    results.innerHTML += "Tolerance: " + end_step_length.toFixed(3) + ", real error: " + error.toFixed(3);
    last_error = error;
}

function radio(n){
    for(var i = 1; i <=4; i++){
        radio_i = document.getElementById("button_" + i);
        radio_i.disabled = false;
    }
    radio_n = document.getElementById("button_" + n);
    radio_n.disabled = true;
}

var ex_no = 0;
function reset_ex(n){
    document.getElementById("ex_choice").style.display = "none";
    ex_no = n;
    // lines
    a11 = -1.0;    a12 = 1.0;    b1 = -1.0;
    a21 = -0.25;   a22 = 1.0;    b2 = 4.0;
    // start
    start_x = 1.0;
    start_y = 1.0;
    // margin
    end_step_length = 0.5;
    solver_draw(0, 0, false);

    document.getElementById("buttons").style.display = "none";
    for(var i = 1; i <=4; i++){
        document.getElementById("ex_" + i).style.display = "none";
    }
    if(n != 0){
        radio(4 - n + 1);
        document.getElementById("ex_" + n).style.display = "block";
    }else{
        document.getElementById("buttons").style.display = "block;";
        radio(1);
    }
    window.location = "#canvas_ex";
}

function check_ex(){
    if(ex_no == 1)
        if(last_error < 0.25)
            reset_ex(2);
    if(ex_no == 2)
        if(last_iterations == 12)
            reset_ex(3);
    if(ex_no == 3)
        if(last_iterations >= 50)
            reset_ex(4);
    if(ex_no == 4)
        if(last_iterations == 3)
            done();
}

function done(){
    reset_ex(0);
    document.getElementById("congratulations").style.display = "block";
    show_the_rest();
    window.location = "#after_ex";
}

function show_the_rest(){
    document.getElementById("the_rest").style.display = "block";
    document.getElementById("ex_choice").style.display = "none";
}


///////
/// linear multiplier
function inc(counter_name) {
    var counter = document.getElementById(counter_name);
    counter.value = Number(counter.value) + 1;
    eval('change_' + counter_name + '()');
}

function dec(counter_name) {
    var counter = document.getElementById(counter_name);
    counter.value = Number(counter.value) - 1;
    eval('change_' + counter_name + '()');
}

function change_linear_multiplier() {
    var multiplier = Number(document.getElementById('linear_multiplier').value);
    var row = document.getElementById('linear_row2');
    if(multiplier != 0)
        row.innerHTML = coefficient(multiplier, "x<sub>1</sub>") + " + " +  coefficient(2 * multiplier, "x<sub>2</sub>") + " = " + printable(3 * multiplier);
    else
        row.innerHTML = "Except for 0, yes.";
}

//////
/// underspecified
function change_s3_1_1() {}
function change_s3_1_2() {}
function change_s3_1_3() {}
function change_s3_1_4() {}
function change_s3_2_1() {}
function change_s3_2_2() {}
function change_s3_2_3() {}
function change_s3_2_4() {}
    </script>
  </head>
  <body>
    <center>
    <h1>
Programmer's introduction to linear systems
    </h1>
    <p>
Being a practicing programmer, you are very unlikely to implement yet another linear system solving algorithm. This tutorial doesn't cover the implementation details therefore. Although, you will probably face the problems that may be solved in a form of linear systems, and often more elegantly than by any other means. This tutorial is all about the concepts that should help you recognize these problems and find the best solution for them.
    </p>
    <p>
And even if you are not interested in linear algebra at all, you might still find this tutorial interesting. Things as convergence, computational error, algorithmic complexity, — are all easy to show on a task as intuitive and visual as solving a simple linear system.
    </p>
    <h2>
Representation
    </h2>
    <p>
Linear system is a system of linear equations. Linear equation is a sum of weighted variables that equals a constant. In two-dimensional space, it is also an equation for an actual line. In 3 dimensions it's a plane, in 4 — a hyperplane, and so on.
    </p>
    <p>
The system may be represented as an array of equations.
    </p>
    <table class="formula">
    <tr>
    <td rowspan=2 class="brackets">{</td>
    <td id="system_1_system_row1">
    a11x1 + a12x2 = b1
    </td>
    </tr><tr>
    <td id="system_1_system_row2">
    a21x1 + a22x2 = b2
    </td>
    </tr>
    </table>
    <p>
The very same array of equations constitutes the matrix equation.
    </p>
    
    <table class="formula">
    <tr>
    <td class="brackets">[</td>
    <td id="system_1_matrix_col1">
1<br>0
    </td>
    <td id="system_1_matrix_col2">
0<br>1
    </td>
    <td class="brackets">]</td>
    <td class="brackets">[</td>
    <td>
x<sub>1</sub> <br> x<sub>2</sub>
    </td>
    <td class="brackets">]</td>
    <td> = </td>
    <td class="brackets">[</td>
    <td id="system_1_matrix_col3">
0<br>1
    </td>
    <td class="brackets">]</td>      
    </tr>
    </table>
        
    <p>
And in the simplest case it may also have a graphic form.
    </p>
    <canvas id="system_1" width=640 height=512></canvas>
    <p class="comment">
You can drag the lines and see how the equations from above change.
    </p>
    <div style="text-align:right; width:640px; padding-bottom:12pt;">
        <button type="button" id="button_1_reset" onclick="reset_system_1()">Reset</button>
    </div>
    
    <p>
Graphic form is a useful mental model because it makes the solution visual. The solution is merely an intersecion of lines.
    </p>    
    
    <form>
        <b>Quest 1.</b> Using the plot above, please make a system that has a solution: <i>x<sub>1</sub> = 0, x<sub>2</sub> = 0</i>. Then press the “Check!” button.
        <div id="reply_quest_1" style="padding-top:6pt;"></div>
        <div id="buttons_quest_1" style="text-align:right;">
            <button type="button" id="button_1_1" onclick="done_system_1_quest_1()">Check!</button>
        </div>
    </form>
        
    <p>
Even a well specified system may not have a solution (an intersection).
    </p> 

    <form>
        <b>Quest 2.</b> Using the same plot above, please make a system with no solution.
        <div id="reply_quest_2" style="padding-top:6pt;"></div>
        <div id="buttons_quest_2" style="text-align:right;">
            <button type="button" id="button_1_2" onclick="done_system_1_quest_2()">Check!</button>
        </div>
    </form>
    
    <p>
And sometimes it may have not a single, but an infinite number of solutions. 
    </p>    

    <form>
        <b>Quest 3.</b> Using the same plot above, please make a system with infinite solutions.
        <div id="reply_quest_3" style="padding-top:6pt;"></div>
        <div id="buttons_quest_3" style="text-align:right;">
            <button type="button" id="button_1_3" onclick="done_system_1_quest_3()">Check!</button>
        </div>
    </form>
        
    <p>
This may be a problem for numeric methods aimed to find a single solution. They may report an error or, even worse, supply you with a first best solution they find. In this case you better check your equations for linear dependency.
    </p>
    <p>
You see, when you multiply every coefiicient of an equation, and the constant, to the same number, all the facts about the points it describes remain intact. It's still the same equation, it's still the same line.
    </p>
    <table class="formula">
    <tr>
    <td id="linear_row1">
    x<sub>1</sub> + 2x<sub>2</sub> = 3
    </td>
    </tr><tr>
    <td>
    <button type="button" class="incdec" onclick="dec('linear_multiplier')">-</button><input type="text" style="width: 32pt;" id="linear_multiplier" value="2" oninput="change_linear_multiplier();"><button type="button" class="incdec" onclick="inc('linear_multiplier')">+</button> 
    </td>
    </tr><tr>
    <td id="linear_row2">
    2x<sub>1</sub> + 4x<sub>2</sub> = 6
    </td>
    </tr>
    </table>
  
    <p>
Sometimes, systems have more equations than the variables. These systems are called <b>overspecified</b>.
    </p>
    <canvas id="system_2" width=640 height=512></canvas> 
    <div style="text-align:right; width:640px; padding-bottom:12pt;">
        <button type="button" id="button_2_reset" onclick="reset_system_2()">Reset</button>
    </div>    
    <p>
In general case, these systems don't have a solution, but in some rare cases they do.
    </p>
    
    <form>
        <b>Quest 4.</b> Using the 3-lines plot, please make a system with a single solution.
        <div id="reply_quest_4" style="padding-top:6pt;"></div>
        <div id="buttons_quest_4" style="text-align:right;">
            <button type="button" id="button_2_4" onclick="done_system_2_quest_4()">Check!</button>
        </div>
    </form>    
    
    <p>
Sometimes, systems have more variables than the equations. These systems are <b>underspecified</b>.
    </p>   
    <p>
Of course, in 2-dimensional case they only have one equation, and the infinite number of solutions. Every point that lies on the equation's line is a solution. But in more-dimensional cases underspecified systems might not have any solutions at all.
    </p>
    
     <form>
        <b>Quest 5.</b> Using the matrix form below, please make an underspecified system of 3 equations that don't have a solution.
        
        <div id="reply_quest_5" style="padding-top:6pt;"></div>
            <table class="formula" style="padding:0 0 6pt 0;">
            <tr>
            <td class="brackets">[</td>
            <td id="system_3_matrix_col1">
<nobr><button type="button" class="incdec" onclick="dec('s3_1_1')">-</button><input type="text" id="s3_1_1" value="1" oninput=""><button type="button" class="incdec" onclick="inc('s3_1_1')">+</button></nobr>
<br>
<nobr><button type="button" class="incdec" onclick="dec('s3_2_1')">-</button><input type="text" id="s3_2_1" value="2" oninput=""><button type="button" class="incdec" onclick="inc('s3_2_1')">+</button></nobr>
            </td>
            <td id="system_3_matrix_col2">
<nobr><button type="button" class="incdec" onclick="dec('s3_1_2')">-</button><input type="text" id="s3_1_2" value="2" oninput=""><button type="button" class="incdec" onclick="inc('s3_1_2')">+</button></nobr>
<br>
<nobr><button type="button" class="incdec" onclick="dec('s3_2_2')">-</button><input type="text" id="s3_2_2" value="3" oninput=""><button type="button" class="incdec" onclick="inc('s3_2_2')">+</button></nobr>
            </td>
            <td id="system_3_matrix_col3">
<nobr><button type="button" class="incdec" onclick="dec('s3_1_3')">-</button><input type="text" id="s3_1_3" value="3" oninput=""><button type="button" class="incdec" onclick="inc('s3_1_3')">+</button></nobr>
<br>
<nobr><button type="button" class="incdec" onclick="dec('s3_2_3')">-</button><input type="text" id="s3_2_3" value="4" oninput=""><button type="button" class="incdec" onclick="inc('s3_2_3')">+</button></nobr>
            </td>
            <td class="brackets">]</td>
            <td class="brackets">[</td>
            <td>
        x<sub>1</sub> <br> x<sub>2</sub> <br> x<sub>3</sub>
            </td>
            <td class="brackets">]</td>
            <td> = </td>
            <td class="brackets">[</td>
            <td id="system_3_matrix_col4">
<nobr><button type="button" class="incdec" onclick="dec('s3_1_4')">-</button><input type="text" id="s3_1_4" value="4" oninput=""><button type="button" class="incdec" onclick="inc('s3_1_4')">+</button></nobr>
<br>
<nobr><button type="button" class="incdec" onclick="dec('s3_2_4')">-</button><input type="text" id="s3_2_4" value="5" oninput=""><button type="button" class="incdec" onclick="inc('s3_2_4')">+</button></nobr>
            </td>
            <td class="brackets">]</td>      
            </tr>
            </table>
        <div id="buttons_quest_5" style="text-align:right;">
            <button type="button" id="button_3_5" onclick="done_system_3_quest_5()">Check!</button>
        </div>
    </form>       
    
    
    
    
    
    
    <canvas id="solver" width=640 height=512></canvas>
    <p class="results" id="results">
    </p>
    <form>
        <div id="buttons">
        <center>
            <button type="button" id="button_1" onclick="radio(1)" disabled="true">Red line</button>
            <button type="button" id="button_2" onclick="radio(2)">Blue line</button>
            <button type="button" id="button_3" onclick="radio(3)">Start point</button>
            <button type="button" id="button_4" onclick="radio(4)">Threshold</button>
        </center>
        </div>
    </form>

    <p>
...
    </p>

    <script language="JavaScript">
        init_plot_named('system_1');
        init_plot_named('system_2')
        change_linear_multiplier();
        init_solver();
    </script>

    <p class="footer">
<a class="twitter-share-button"
  href="https://twitter.com/intent/tweet?text=text&url=https://wordsandbuttons.online/programmers_introduction_to_linear_systems.html&hashtags=linear,systems,tutorial&via=wordsandbuttons"
  data-size="large">
Tweet</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <br>      
There are more words and buttons on <a href="index.html">wordsandbuttons.online</a>.
    </p>
    </center>
  </body>
</html>
