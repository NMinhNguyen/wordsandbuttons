<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Playing game of chance with C++ inline keyword</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
    <style>
body{
    margin: 0 0 0 0;
}

a{
    text-decoration: none;
}

h1 {
    padding-top: 32pt;
    font-size: 24pt;
    width: 600pt;
    text-align: left;
}

h2 {
    padding-top: 16pt;
    font-size: 20pt;
    width: 555pt;
    text-align: left;
}

p {
    font-size: 16pt;
    width: 505pt;
    text-align: left;
}

.footer {
    margin-top: 64pt;
    padding-bottom: 32pt;
    font-family: sans-serif;
    font-size: 16pt;
    text-align: left;
}

pre {
    margin: 0 0 0 0;
    padding-top: 12pt;
    padding-left: 12pt;
    padding-right: 12pt;
    padding-bottom: 12pt;
    font-size: 12pt;
    text-align: left;
    width: 300pt;
}

.code_piece {
    font-family: monospace;
    padding-left: 4pt;
    padding-right: 4pt;
}


table {
    border-width: 0pt;
}

td {
    vertical-align: top;
    padding: 6pt 12pt 6pt 12pt;
    font-size: 16pt;
    border: 1px solid black;
    width: 505pt;
}

button{
    width: 248pt;
    height: 42pt;
    margin-left:4pt;
    margin-right:4pt;
    font-size: 16pt;
}

li {
    font-size: 16pt;
    width: 505pt;
    text-align: left;
    padding-bottom: 6pt;
}

u {
    border-bottom: 1px dotted #000;
    text-decoration: none;
    cursor: pointer;
}
    </style>
    <script language="JavaScript">

const SLOT_STEPS_MIN = 5;
const SLOT_STEPS_RANDOM = 7;
const SPINNING_SPEED = 1.0/8.0;

var slots_start_t = [0.0, 0.0, 0.0]
var slots_end_t = [0.0, 0.0, 0.0]
var slots_t = [0.0, 0.0, 0.0]

var winner_t = 0.0;

function y_from_slots(i){
    var t = slots_end_t[i] == slots_start_t[i] 
        ? 0.0 
        : (slots_t[i] - slots_start_t[i]) / (slots_end_t[i] - slots_start_t[i]);
    var f = Math.sin(Math.PI * t / 2.0);
    var y = Math.floor(300 * (slots_start_t[i] + f * (slots_end_t[i] - slots_start_t[i]))) % 600;
    return y;
}

function draw_results(){
    var d = document.getElementById("results");
    var d_context = d.getContext("2d");
    
    // background
    d_context.fillStyle="#eeeeee";
    d_context.fillRect(0, 0, 700, 300);
    
    d_context.font = '32px serif';
    d_context.textAlign = 'center';
    d_context.textBaseline = 'middle';
    
    // debug / release
    d_context.fillStyle="#22BB00";
    d_context.fillText("Debug", 150, y_from_slots(0) - 450);    
    d_context.fillText("Debug", 150, y_from_slots(0) + 150);
    d_context.fillStyle="#BB0022";
    d_context.fillText("Release", 150, y_from_slots(0) - 150);
    
    // static / dynamic
    d_context.fillStyle="#22BB00";
    d_context.fillText("Dynamic", 350, y_from_slots(1) - 450);    
    d_context.fillText("Dynamic", 350, y_from_slots(1) + 150);
    d_context.fillStyle="#BB0022";
    d_context.fillText("Static", 350, y_from_slots(1) - 150);
    
    // x64 / x86
    d_context.fillStyle="#22BB00";
    d_context.fillText("x64", 550, y_from_slots(2) - 450);    
    d_context.fillText("x64", 550, y_from_slots(2) + 150);
    d_context.fillStyle="#BB0022";
    d_context.fillText("x86", 550, y_from_slots(2) - 150);
                
    // winning
    if(winner_t > 0) {
        d_context.fillStyle="#000000";
        d_context.fillRect(0, 100, 700, 100);
        d_context.fillStyle="#BB0022";
        var size = 48 - (winner_t * 5) % 10;
        d_context.font = String(size) + 'px monospace';
        d_context.fillText("☹☹☹ You broke the build! ☹☹☹", 350, 150); 
    }
}

function slots_step(){
    // spinning
    for(var i = 0; i < 3; ++i) {
        if(slots_t[i] < slots_end_t[i])
            slots_t[i] += SPINNING_SPEED;
        if(slots_t[i] >= slots_end_t[i] && slots_start_t[i] != slots_end_t[i]){
            slots_start_t[i] = slots_end_t[i];
            slots_t[i] = slots_end_t[i];
            }
        }
        
    // winning
    var you_won = true;
    for(var i = 0; i < 3; ++i)
        if(slots_start_t[i] != slots_end_t[i] || slots_start_t[i] % 2 == 0)
            you_won = false;
    if(you_won) {
        winner_t = 31.0;
        for(var i = 0; i < 3; ++i) {
            slots_end_t[i] += 31.0;
        }
    }
    if(winner_t > 0)
        winner_t -= SPINNING_SPEED;
    draw_results();
}

function init_results(){
    draw_results();
    setInterval(slots_step, 50);
}

function pull_the_lever(){
    for(var i = 0; i < 3; ++i){
        if(slots_t[i] < slots_end_t[i])
            return;
    }
    for(var i = 0; i < 3; ++i){
        slots_end_t[i] += SLOT_STEPS_MIN + Math.floor((Math.random() * SLOT_STEPS_RANDOM));
    }
}
    </script>
  </head>
  <body>
    <center>
    <h1>
Playing game of chance with C++ inline keyword
    </h1>
    <p>

    </p>

    <canvas id="results" width=700 height=300></canvas>
    <script language="JavaScript">
    init_results();
    </script>
    <br>
    <button type="button" onclick="pull_the_lever()">Pull the lever!</button>    
    <p>

    </p>

    <p class="footer">
There are more words and buttons on <a href="index.html">wordsandbuttons.online</a>.
    </p>
    </center>
  </body>
</html>
